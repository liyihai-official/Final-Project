\doxysection{pinn.\+hpp}
\hypertarget{pinn_8hpp_source}{}\label{pinn_8hpp_source}\index{include/pinn/pinn.hpp@{include/pinn/pinn.hpp}}
\mbox{\hyperlink{pinn_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#ifndef\ FINAL\_PROJECT\_PINN\_HPP}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#define\ FINAL\_PROJECT\_PINN\_HPP}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <torch/torch.h>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <torch/script.h>}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{types_8hpp}{types.hpp}}>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{pinn_2types_8hpp}{pinn/types.hpp}}>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <multiarray.hpp>}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacefinal__project}{final\_project}}\ \{\ \textcolor{keyword}{namespace\ }PINN\ \{}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl}{HeatPINNImpl}}}
\DoxyCodeLine{00029\ \ \ :\ torch::nn::Module}
\DoxyCodeLine{00030\ \{}
\DoxyCodeLine{00031\ \ \ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_ad457be7ef7bb0e93ce2e6188266e7ec0}{HeatPINNImpl}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00032\ \ \ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_ad457be7ef7bb0e93ce2e6188266e7ec0}{HeatPINNImpl}}(\mbox{\hyperlink{namespacefinal__project_a3ea1691db0c46cfd864ba89f5de08bb6}{Integer}},\ \mbox{\hyperlink{namespacefinal__project_a3ea1691db0c46cfd864ba89f5de08bb6}{Integer}},\ \mbox{\hyperlink{namespacefinal__project_a3ea1691db0c46cfd864ba89f5de08bb6}{Integer}});}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ torch::Tensor\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_aa677e51a40916ed98ceea75b60949e82}{forward}}(torch::Tensor\ \&);}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ torch::nn::Linear\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_adb4dbcc81fdb453f60e538343f9eb2ac}{input}},\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a16b957f15b3c4caf024b7e8759a077aa}{h0}},\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a2a806f5e3c6fdf69d1011f5745f8343b}{h1}},\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a57a99ddbd0c1c481ffe6e6f32c0aa828}{h2}},\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a8b96951154010de8f8074bb954db446b}{output}};}
\DoxyCodeLine{00037\ \ \ \textcolor{comment}{//\ torch::nn::Conv1d\ conv0,\ conv1,}}
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{//\ torch::nn::Dropout\ drop0;}}
\DoxyCodeLine{00039\ \};\ \textcolor{comment}{//\ struct\ HeatPINNImpl}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \mbox{\hyperlink{namespacefinal__project_1_1_p_i_n_n_a55f99f126418e22dadea2717505c686d}{TORCH\_MODULE}}(HeatPINN);}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ torch::Tensor\ \mbox{\hyperlink{namespacefinal__project_1_1_p_i_n_n_af5cfc77828e74719e75ff8d75f8aadc5}{get\_pde\_loss}}(torch::Tensor\ \&,\ torch::Tensor\ \&,\ torch::Device\ \&);}
\DoxyCodeLine{00044\ torch::Tensor\ \mbox{\hyperlink{namespacefinal__project_1_1_p_i_n_n_ae41755a6a185a7335febe98cde949e59}{get\_total\_loss}}(HeatPINN\ \&,\ torch::Tensor\ \&,\ torch::Tensor\ \&,\ torch::Tensor\ \&,\ torch::Device\ \&);}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \}\ \textcolor{comment}{//\ namespace\ PINN}}
\DoxyCodeLine{00049\ \}\ \textcolor{comment}{//\ namespace\ final\_project}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ conv1\ =\ register\_module("{}conv1"{},\ torch::nn::Conv1d(1,\ 16,\ /*kernel\_size=*/3));\ //\ 1\ input\ channel,\ 16\ output\ channels,\ kernel\ size\ 3}}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ conv2\ =\ register\_module("{}conv2"{},\ torch::nn::Conv1d(16,\ 32,\ /*kernel\_size=*/3));\ //\ 16\ input\ channels,\ 32\ output\ channels,\ kernel\ size\ 3}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dropout1\ =\ register\_module("{}dropout1"{},\ torch::nn::Dropout(0.5));\ //\ Dropout\ with\ 50\%\ probability}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacefinal__project}{final\_project}}\ \{\ \textcolor{keyword}{namespace\ }PINN\ \{}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{inline}\ }
\DoxyCodeLine{00072\ \ \ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_ad457be7ef7bb0e93ce2e6188266e7ec0}{HeatPINNImpl::HeatPINNImpl}}(\mbox{\hyperlink{namespacefinal__project_a3ea1691db0c46cfd864ba89f5de08bb6}{Integer}}\ insize,\ \mbox{\hyperlink{namespacefinal__project_a3ea1691db0c46cfd864ba89f5de08bb6}{Integer}}\ outsize,\ \mbox{\hyperlink{namespacefinal__project_a3ea1691db0c46cfd864ba89f5de08bb6}{Integer}}\ hidsize)}
\DoxyCodeLine{00073\ :\ }
\DoxyCodeLine{00074\ \ \ input(torch::nn::Linear(insize,\ hidsize)),}
\DoxyCodeLine{00075\ \ \ h0(torch::nn::Linear(hidsize,\ hidsize)),}
\DoxyCodeLine{00076\ \ \ h1(torch::nn::Linear(hidsize,\ hidsize)),}
\DoxyCodeLine{00077\ \ \ \textcolor{comment}{//\ drop0(torch::nn::Dropout(0.5)),}}
\DoxyCodeLine{00078\ \ \ h2(torch::nn::Linear(hidsize,\ hidsize)),}
\DoxyCodeLine{00079\ \ \ output(torch::nn::Linear(hidsize,\ outsize))}
\DoxyCodeLine{00080\ \{}
\DoxyCodeLine{00081\ \ \ register\_module(\textcolor{stringliteral}{"{}Input"{}},\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_adb4dbcc81fdb453f60e538343f9eb2ac}{input}});}
\DoxyCodeLine{00082\ \ \ register\_module(\textcolor{stringliteral}{"{}hidden\_0"{}},\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a16b957f15b3c4caf024b7e8759a077aa}{h0}});}
\DoxyCodeLine{00083\ \ \ register\_module(\textcolor{stringliteral}{"{}hidden\_1"{}},\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a2a806f5e3c6fdf69d1011f5745f8343b}{h1}});}
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ register\_module("{}drop0"{},\ drop0);}}
\DoxyCodeLine{00085\ \ \ register\_module(\textcolor{stringliteral}{"{}hidden\_2"{}},\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a57a99ddbd0c1c481ffe6e6f32c0aa828}{h2}});}
\DoxyCodeLine{00086\ \ \ register\_module(\textcolor{stringliteral}{"{}output"{}},\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a8b96951154010de8f8074bb954db446b}{output}});}
\DoxyCodeLine{00087\ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00093\ \textcolor{keyword}{inline}\ }
\DoxyCodeLine{00094\ \ \ torch::Tensor}
\DoxyCodeLine{00095\ \ \ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_aa677e51a40916ed98ceea75b60949e82}{HeatPINNImpl::forward}}(torch::Tensor\ \&\ \mbox{\hyperlink{vis2d_8m_a08ed1df715226269031ac902d12e9867}{x}})}
\DoxyCodeLine{00096\ \{}
\DoxyCodeLine{00097\ \ \ torch::Tensor\ out\ =\ torch::tanh(\mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_adb4dbcc81fdb453f60e538343f9eb2ac}{input}}(\mbox{\hyperlink{vis2d_8m_a08ed1df715226269031ac902d12e9867}{x}}));}
\DoxyCodeLine{00098\ \ \ out\ =\ torch::tanh(\mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a16b957f15b3c4caf024b7e8759a077aa}{h0}}(out));}
\DoxyCodeLine{00099\ \ \ out\ =\ torch::tanh(\mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a2a806f5e3c6fdf69d1011f5745f8343b}{h1}}(out));}
\DoxyCodeLine{00100\ \ \ \textcolor{comment}{//\ out\ =\ drop0(out);}}
\DoxyCodeLine{00101\ \ \ out\ =\ torch::tanh(\mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a57a99ddbd0c1c481ffe6e6f32c0aa828}{h2}}(out));}
\DoxyCodeLine{00102\ \ \ out\ =\ \mbox{\hyperlink{structfinal__project_1_1_p_i_n_n_1_1_heat_p_i_n_n_impl_a8b96951154010de8f8074bb954db446b}{output}}(out);}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00105\ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00116\ \textcolor{keyword}{inline}\ }
\DoxyCodeLine{00117\ torch::Tensor\ \mbox{\hyperlink{namespacefinal__project_1_1_p_i_n_n_af5cfc77828e74719e75ff8d75f8aadc5}{get\_pde\_loss}}(torch::Tensor\ \&\ \mbox{\hyperlink{vis2d_8m_a1a45186fe9af663ba838f1023f921ecf}{u}},\ torch::Tensor\ \&\ X,\ torch::Device\ \&\ device)}
\DoxyCodeLine{00118\ \{}
\DoxyCodeLine{00119\ \ \ torch::Tensor\ du\_dX\ \{}
\DoxyCodeLine{00120\ \ \ \ \ torch::autograd::grad(}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \{\mbox{\hyperlink{vis2d_8m_a1a45186fe9af663ba838f1023f921ecf}{u}}\},}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \{X\},}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \{torch::ones\_like(\mbox{\hyperlink{vis2d_8m_a1a45186fe9af663ba838f1023f921ecf}{u}})\},}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \textcolor{keyword}{true},}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \textcolor{keyword}{true},\ }
\DoxyCodeLine{00126\ \ \ \ \ \ \ true}
\DoxyCodeLine{00127\ \ \ \ \ )[0]}
\DoxyCodeLine{00128\ \ \ \};}
\DoxyCodeLine{00129\ \ \ torch::Tensor\ du\_dx\ \{\ du\_dX.index(\{\textcolor{stringliteral}{"{}..."{}},\ 0\})\ \};}
\DoxyCodeLine{00130\ \ \ torch::Tensor\ du\_dy\ \{\ du\_dX.index(\{\textcolor{stringliteral}{"{}..."{}},\ 1\})\ \};}
\DoxyCodeLine{00131\ \ \ }
\DoxyCodeLine{00132\ \ \ torch::Tensor\ du\_dxx\ \{}
\DoxyCodeLine{00133\ \ \ \ \ torch::autograd::grad(}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \{du\_dx\},\ \{X\},\ \{torch::ones\_like(du\_dx),\},\ }
\DoxyCodeLine{00135\ \ \ \ \ \ \ \textcolor{keyword}{true},\ \textcolor{keyword}{true},\ \textcolor{keyword}{true})[0].index(\{\textcolor{stringliteral}{"{}..."{}},\ 0\})}
\DoxyCodeLine{00136\ \ \ \};}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ torch::Tensor\ du\_dyy\ \{}
\DoxyCodeLine{00139\ \ \ \ \ torch::autograd::grad(}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \{du\_dy\},\ \{X\},\ \{torch::ones\_like(du\_dy),\},\ }
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{keyword}{true},\ \textcolor{keyword}{true},\ \textcolor{keyword}{true})[0].index(\{\textcolor{stringliteral}{"{}..."{}},\ 1\})}
\DoxyCodeLine{00142\ \ \ \};}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \textcolor{keywordflow}{if}\ (X.size(1)\ ==\ \mbox{\hyperlink{pinn_2types_8hpp_a5b96ad08a75316764fdfa80eb1d37df6}{IN\_SIZE\_3D}})}
\DoxyCodeLine{00145\ \ \ \{}
\DoxyCodeLine{00146\ \ \ \ \ torch::Tensor\ du\_dz\ \{\ du\_dX.index(\{\textcolor{stringliteral}{"{}..."{}},\ 2\})\ \};}
\DoxyCodeLine{00147\ \ \ \ \ torch::Tensor\ du\_dzz\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ torch::autograd::grad(}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \{du\_dz\},\ \{X\},\ \{torch::ones\_like(du\_dz),\},}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{keyword}{true},\ \textcolor{keyword}{true},\ \textcolor{keyword}{true})[0].index(\{\textcolor{stringliteral}{"{}..."{}},\ 2\})}
\DoxyCodeLine{00151\ \ \ \ \ \};}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordflow}{return}\ torch::mean(torch::square(du\_dxx\ +\ du\_dyy\ +\ du\_dzz));}
\DoxyCodeLine{00153\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00154\ \ \ \{}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordflow}{return}\ torch::mean(torch::square(du\_dxx\ +\ du\_dyy));}
\DoxyCodeLine{00156\ \ \ \}}
\DoxyCodeLine{00157\ \ \ \textcolor{comment}{//\ torch::Tensor\ f\_X\ \{\ torch::zeros\_like(du\_dxx)\ \};}}
\DoxyCodeLine{00158\ \ \ \textcolor{comment}{//\ return\ torch::mse\_loss(\ du\_dxx\ +\ du\_dyy,\ f\_X\ );}}
\DoxyCodeLine{00159\ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00169\ \textcolor{keyword}{inline}\ }
\DoxyCodeLine{00170\ torch::Tensor\ \mbox{\hyperlink{namespacefinal__project_1_1_p_i_n_n_ae41755a6a185a7335febe98cde949e59}{get\_total\_loss}}(HeatPINN\ \&\ net,\ }
\DoxyCodeLine{00171\ \ \ torch::Tensor\ \&\ X,\ torch::Tensor\ \&\ X\_train,\ torch::Tensor\ \&\ Y\_train,\ }
\DoxyCodeLine{00172\ \ \ torch::Device\ \&\ device)}
\DoxyCodeLine{00173\ \{}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ torch::Tensor\ \mbox{\hyperlink{vis2d_8m_a1a45186fe9af663ba838f1023f921ecf}{u}}\ \{\ net-\/>forward(X)\ \};}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordflow}{return}\ torch::mse\_loss(net-\/>forward(X\_train),\ Y\_train)\ +\ \mbox{\hyperlink{namespacefinal__project_1_1_p_i_n_n_af5cfc77828e74719e75ff8d75f8aadc5}{get\_pde\_loss}}(\mbox{\hyperlink{vis2d_8m_a1a45186fe9af663ba838f1023f921ecf}{u}},\ X,\ device);}
\DoxyCodeLine{00177\ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \}\ \textcolor{comment}{//\ namespace\ PINN}}
\DoxyCodeLine{00180\ \}\ \textcolor{comment}{//\ namespace\ final\_project}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ end\ define\ FINAL\_PROJECT\_PINN\_HPP}}

\end{DoxyCode}
